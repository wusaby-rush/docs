---
type: integration
title: '@astrojs/mdx'
description: 了解如何在你的 Astro 项目中使用 @astrojs/mdx 集成。
githubURL: 'https://github.com/withastro/astro/tree/main/packages/integrations/mdx/'
hasREADME: true
category: other
i18nReady: true
---


此 **[Astro 集成][astro-integration]** 能够使用 [MDX](https://mdxjs.com/) 组件，并允许你通过 `.mdx` 文件创建页面。

## 为什么是 MDX？

MDX 允许你在 Astro 项目的 [Markdown 内容中使用变量、JSX 表达式和组件](/zh-cn/guides/markdown-content/#mdx-独有特性)。如果你有现有的用 MDX 编写的内容，这个集成允许你把这些文件带到你的 Astro 项目中。

## 安装

### 快速安装

`astro add` 命令行工具为你自动进行安装。在一个新的终端窗口中运行下列其中一个命令。（如果你不确定你使用的是哪个包管理器，请运行第一个命令）。然后按照提示，在终端中输入“y”（意思是“是”），每一条都是如此。

```sh
# Using NPM
npx astro add mdx
# Using Yarn
yarn astro add mdx
# Using PNPM
pnpm astro add mdx
```

如果你遇到任何问题，[请随时在 GitHub 上向我们报告](https://github.com/withastro/astro/issues)并尝试下面的手动安装步骤。

### 手动安装

首先，用你的包管理器安装 `@astrojs/mdx` 包。如果你使用的是npm或者不确定哪个包管理器，在终端运行这个：

```sh
npm install @astrojs/mdx
```

然后，使用 `integrations` 属性将这个集成应用到你的 `astro.config.*` 文件：

**`astro.config.mjs`**

```js ins={2} "mdx()"
import { defineConfig } from 'astro/config';
import mdx from '@astrojs/mdx';

export default defineConfig({
  // ...
  integrations: [mdx()],
});
```

### 编辑器集成

[VS Code](https://code.visualstudio.com/)默认支持 Markdown。然而，为了支持 MDX 编辑器，你可能希望在你的 VSCode 配置中添加以下设置，这可以确保编写 MDX 文件时提供类似 Markdown 的编辑体验。

```json title=".vscode/settings.json"
"files.associations": {
    "*.mdx": "markdown"
}
```

## 使用

通过 Astro MDX 集成，你可以在你的 `src/pages/` 目录下添加 `.mdx` 文件来[添加 MDX 页面到你的项目](/zh-cn/guides/markdown-content/#markdown-和-mdx-页面)。你也可以[导入 `.mdx` 文件](/zh-cn/guides/markdown-content/#导入-markdown)到 `.astro` 文件。

Astro 的 MDX 集成为标准的 MDX 增加了额外的功能，包括 Markdown 风格的 frontmatter。这允许你使用大部分 Astro 的内置 Markdown 功能，比如一个[特殊的 frontmatter`layout` 属性](/zh-cn/guides/markdown-content/#frontmatter-layout)和一个[用于标记页面为草稿的属性](/zh-cn/guides/markdown-content/#草稿页面)。

在我们的 [Markdown & MDX 指南](/zh-cn/guides/markdown-content/)中可以看到 MDX 在 Astro 中的工作原理和例子。

访问 [MDX 文档](https://mdxjs.com/docs/what-is-mdx/)，了解使用标准 MDX 功能的情况。

## 配置

一旦 MDX 集成被安装，在你的 Astro 项目中使用 `.mdx` 文件就不需要配置。

你可以通过以下选项配置你的 MDX 的渲染方式：

*   [继承自 Markdown 配置的选项](#继承自-markdown-配置的选项)
*   [`extendMarkdownConfig`](#extendmarkdownconfig)
*   [`recmaPlugins`](#recmaplugins)

### 继承自 Markdown 配置的选项

除了 `drafts`，所有的[`markdown` 配置选项](/zh-cn/reference/configuration-reference/#markdown-选项)可以在 MDX 集成中单独配置。这包括备注和 rehype 插件，语法高亮，等等。选项将默认为你的 Markdown 配置中的选项（[查阅 `extendMarkdownConfig` 选项](#extendmarkdownconfig)来进行修改）。

:::note
对于[包括在构建中标记为草稿的页面](/zh-cn/reference/configuration-reference/#markdowndrafts)没有单独的 MDX 配置。这个 Markdown 设置将被 Markdown 和 MDX 文件所遵守，特别是不能被 MDX 文件所重写。
:::

**`astro.config.mjs`**

```js
import { defineConfig } from 'astro/config';
import mdx from '@astrojs/mdx';
import remarkToc from 'remark-toc';
import rehypeMinifyHtml from 'rehype-minify-html';

export default defineConfig({
  integrations: [
    mdx({
      syntaxHighlight: 'shiki',
      shikiConfig: { theme: 'dracula' },
      remarkPlugins: [remarkToc],
      rehypePlugins: [rehypeMinifyHtml],
      remarkRehype: { footnoteLabel: 'Footnotes' },
      gfm: false,
    })
  ]
})
```

:::caution
MDX 不支持以字符串形式传递备注和 rehype 插件。你应该安装、导入并应用插件功能来代替。
:::

📚 参见 [Markdown 选项参考](/zh-cn/reference/configuration-reference/#markdown-选项) 以获得完整的选项列表。

### `extendMarkdownConfig`

*   **类型：** `boolean`
*   **默认值：** `true`

MDX 将默认扩展[你的项目现有的 Markdown 配置](/zh-cn/reference/configuration-reference/#markdown-选项)。要覆盖个别选项，你可以在你的 MDX 配置中进行等价配置。

例如，假设你需要禁用 GitHub-Flavored Markdown，并为 MDX 文件应用一套不同的注释插件。你可以像这样应用这些选项，`extendMarkdownConfig` 默认为启用：

**`astro.config.mjs`**

```js
import { defineConfig } from 'astro/config';
import mdx from '@astrojs/mdx';

export default defineConfig({
  markdown: {
    syntaxHighlight: 'prism',
    remarkPlugins: [remarkPlugin1],
    gfm: true,
  },
  integrations: [
    mdx({
      // 继承自 Markdown 的 `syntaxHighlight`

      // Markdown `remarkPlugins` 被忽略，
      // 只启用 `remarkPlugin2`。
      remarkPlugins: [remarkPlugin2],
      // `gfm` 被重写为 `false`
      gfm: false,
    })
  ]
});
```

你可能还需要在 MDX 中禁用 `markdown` 配置扩展。为此，将 `extendMarkdownConfig` 设置为 `false`：

**`astro.config.mjs`**

```js
import { defineConfig } from 'astro/config';
import mdx from '@astrojs/mdx';

export default defineConfig({
  markdown: {
    remarkPlugins: [remarkPlugin1],
  },
  integrations: [
    mdx({
      // Markdown 配置现在被忽略了
      extendMarkdownConfig: false,
      // `remarkPlugins` 没有启用
    })
  ]
});
```

### `recmaPlugins`

这些是直接修改输出 [estree](https://github.com/estree/estree) 的插件。这对于在你的 MDX 文件中修改或注入 JavaScript 变量很有用。

我们建议[使用 AST Explorer](https://astexplorer.net/)来处理 estree 的输出，并尝试 [`estree-util-visit`](https://unifiedjs.com/explore/package/estree-util-visit/) 来搜索整个 JavaScript 节点。

## 例子

*   [Astro MDX 启动模板](https://github.com/withastro/astro/tree/latest/examples/with-mdx)显示了如何在你的 Astro 项目中使用 MDX 文件。

## 故障排除

如需帮助，请查看 [Discord](https://astro.build/chat) 上的 `#support` 频道。我们友好的支持小组成员将在这里提供帮助！

你也可以查看我们的 [Astro 集成文档][astro-integration]，了解更多关于集成的信息。

## 贡献

这个项目由 Astro 的核心团队维护，欢迎你提交 issue 或 PR！

## 更改日志

有关该集成的变化历史，请参阅 [CHANGELOG.md](https://github.com/withastro/astro/tree/main/packages/integrations/tailwind/CHANGELOG.md)。

[astro-integration]: /zh-cn/guides/integrations-guide/

[astro-ui-frameworks]: /zh-cn/core-concepts/framework-components/#使用框架组件
